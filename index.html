<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Birthday Puzzle → Word Search → Surprise Game</title>
<style>
  :root { --pink1:#ffe4e1; --pink2:#fff0f5; --accent:#d63384; --accent-dark:#b30059; --text:#333; --muted:#666; }
  *{box-sizing:border-box}
  body{
    font-family: Arial, sans-serif;
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    min-height:100vh; margin:0; background:linear-gradient(to bottom, var(--pink1), var(--pink2));
  }
  h1{ color:var(--accent); text-align:center; margin:12px 0 6px }
  .screen{ width:100%; max-width:440px; padding:18px }
  .hidden{ display:none }
  .card{ background:#fff; border-radius:14px; padding:16px; box-shadow:0 10px 25px rgba(0,0,0,.08) }
  .btn{ margin:10px; padding:10px 20px; border:none; border-radius:10px; background:var(--accent); color:#fff; font-size:1em; cursor:pointer }
  .btn:active{ transform:translateY(1px) }
  .link-btn{ background:none; border:none; color:var(--accent-dark); text-decoration:underline; padding:6px 10px; cursor:pointer; font-size:.95em }
  .fade-out{ animation:fadeOut .5s ease forwards } 
  @keyframes fadeOut{ to{ opacity:0; visibility:hidden } }

  /* Puzzle */
  #puzzle{ display:grid; gap:2px; margin-top:12px }
  .tile{ cursor:pointer; background-repeat:no-repeat; background-size:100% 100%; border-radius:6px; box-shadow:0 1px 2px rgba(0,0,0,.06) }
  #message{ margin-top:14px; font-size:1.05em; color:var(--text); text-align:center }

  /* Word Search */
  .ws-wrap{ display:flex; flex-direction:column; gap:10px }
  .ws-grid{ display:grid; grid-template-columns:repeat(12, 1fr); gap:4px; touch-action:none; }
  .ws-cell{
    background:#fff; border:1px solid rgba(0,0,0,.08); border-radius:6px;
    width:100%; aspect-ratio:1 / 1; display:flex; align-items:center; justify-content:center;
    font-weight:bold; user-select:none;
  }
  .ws-cell.ws-selected{ background:#fff7fb; border-color:#e4c6d6 }
  .ws-cell.ws-found{ background:#d63384; color:#fff; border-color:#d63384 }
  .ws-words{ display:flex; flex-wrap:wrap; gap:8px; justify-content:center; font-size:.95em; color:#666 }
  .ws-words span{ padding:4px 8px; border-radius:999px; background:#f8e7f1 }
  .ws-words span.done{ background:#d63384; color:#fff; text-decoration:line-through }

  /* Memory game */
  .memory-grid{ display:grid; grid-template-columns:repeat(4, 1fr); gap:10px; }
  .memory-card{ position:relative; width:100%; padding-top:120%; perspective:800px; cursor:pointer; }
  .memory-card .inner{ position:absolute; inset:0; border-radius:12px; transition:transform .4s ease; transform-style:preserve-3d; box-shadow:0 8px 18px rgba(0,0,0,.08); }
  .memory-card.flipped .inner{ transform:rotateY(180deg); }
  .face{ position:absolute; inset:0; border-radius:12px; display:flex; align-items:center; justify-content:center; backface-visibility:hidden; font-size:2rem; }
  .front{ background:#fff; border:1px solid rgba(0,0,0,.08); transform:rotateY(180deg); }
  .back{ background:linear-gradient(to bottom, #ffe4e1, #fff0f5); color:#b30059; font-weight:bold; }
</style>
</head>
<body>

<!-- Welcome -->
<div id="welcome-overlay">
  <div class="card" style="max-width:480px;">
    <h1>🎂 Welcome to Your 21st Birthday App 🎂</h1>
    <p>Press continue to get started on your special birthday weekend 💖</p>
    <button class="btn" id="startBtn">Continue</button>
  </div>
</div>

<!-- Screen 1: Photo Puzzle -->
<section id="puzzle-screen" class="screen hidden">
  <h1>💖 Unscramble Our Photo 💖</h1>
  <div class="card">
    <div id="puzzle"></div>
    <div id="message">To get started, unlock this photo of us. Once it’s solved, it’ll take you to the next game 🎁</div>
  </div>
</section>

<!-- Screen 2: Word Search -->
<section id="wordsearch-screen" class="screen hidden">
  <h1>🍳 Breakfast Word Search</h1>
  <div class="card">
    <p style="text-align:center;">Find all the words to reveal the first plan!</p>
    <div class="ws-wrap">
      <div id="wsGrid" class="ws-grid"></div>
      <div id="wsWords" class="ws-words"></div>
    </div>
    <div id="wsResult" style="text-align:center; margin-top:8px; font-weight:bold;"></div>
    <div id="reveal" class="hidden" style="margin-top:14px; text-align:center;">
      <p>🎉 We’re going to <strong>The Spence, Edinburgh</strong> for <strong>9:00 am</strong> — dress code: <strong>comfy & stylish</strong>.</p>
      <img src="restaurantspence.jpg" alt="The Spence Edinburgh" style="width:100%; border-radius:14px; margin-top:12px;">
      <button class="btn" id="continueCoaster">Continue</button>
    </div>
  </div>
</section>

<!-- Screen 3: Coaster Game -->
<section id="coaster-screen" class="screen hidden">
  <h1>🛷 Complete this to discover the next activity</h1>
  <div class="card">
    <canvas id="coasterCanvas" width="360" height="180" style="width:100%; max-width:360px; border-radius:12px; background:#eaf6ff"></canvas>
    <div id="coasterMsg" style="margin-top:10px; text-align:center;">Tap / click to jump. Clear 5 bumps to reveal the plan!</div>
    <div id="coasterReveal" class="hidden" style="margin-top:12px; text-align:center;">
      <p>🎉 Edinburgh <strong>Alpine Coaster</strong> booked at <strong>5</strong> — dress code: <strong>warm & comfortable</strong>.</p>
      <img src="alpine.jpg" alt="Alpine Coaster" style="width:100%; max-width:360px; border-radius:12px; margin-top:10px;">
      <button class="btn" id="continueDinner">Continue</button>
    </div>
  </div>
</section>

<!-- Screen 4: Food Matching -->
<section id="memory-screen" class="screen hidden">
  <h1>🍽️ Match the foods to uncover tonight’s plan</h1>
  <div class="card">
    <div id="memoryGrid" class="memory-grid"></div>
    <div id="memoryMsg" style="text-align:center; margin-top:10px;">Find all 6 pairs.</div>
    <div id="memoryReveal" class="hidden" style="margin-top:12px; text-align:center;">
      <p>🎉 You’re going to <strong>Gaucho</strong> at <strong>9:15pm</strong> — dress to impress ✨</p>
      <img src="gaucho.jpg" alt="Gaucho" style="width:100%; max-width:420px; border-radius:12px; margin-top:10px;">
      <button class="btn" id="continueEnd">Continue</button>
    </div>
  </div>
</section>

<!-- Screen 5: End of Day 1 -->
<section id="end-screen" class="screen hidden">
  <h1>💞 Day 1 — Wrapped with love</h1>
  <div class="card" style="text-align:center;">
    <p>Hope you have an amazing first day for your 21st — I love you 💖</p>
    <p>What do you fancy now?</p>
    <button class="btn" id="chooseBar">Go out to a bar/club 🍸</button>
    <button class="btn" id="chooseHome">Chill at home 🛋️</button>
    <div id="choiceMsg" style="margin-top:12px;"></div>
    <hr style="margin:16px 0;">
    <p>We’ll continue next week — from <strong>Edinburgh</strong> to <strong>London</strong>, with another jam-packed day 🎉</p>
    <button class="btn" id="finishBtn">Finish 🎂</button>
  </div>
</section>

<!-- Screen 6: Final -->
<section id="final-screen" class="screen hidden">
  <div class="card" style="text-align:center;">
    <h1 style="color:#d63384;">🎉 Happy 21st Birthday! 🎉</h1>
    <p style="font-size:1.2em;">With all my love, forever 💖</p>
    <img src="Aryan.jpg" alt="Happy Birthday" style="width:100%; max-width:420px; border-radius:14px; margin-top:10px;">
  </div>
</section>

<script>
/* Confetti */
function confettiBurst(){
  const c=document.createElement('canvas');c.style.position='fixed';c.style.inset=0;c.width=innerWidth;c.height=innerHeight;c.style.pointerEvents='none';document.body.appendChild(c);
  const ctx=c.getContext('2d'),colors=['#ff7aa2','#ffd166','#95d5b2','#9abaff','#f4a261','#e76f51'];
  const parts=[...Array(120)].map(()=>({x:Math.random()*c.width,y:-20,vx:(Math.random()-.5)*4,vy:Math.random()*3+2,g:.05,w:6+Math.random()*6,h:8+Math.random()*8,rot:Math.random()*Math.PI,vr:(Math.random()-.5)*0.2,col:colors[Math.random()*colors.length|0]}));
  const end=Date.now()+1500;
  (function loop(){ctx.clearRect(0,0,c.width,c.height);parts.forEach(p=>{p.vy+=p.g;p.x+=p.vx;p.y+=p.vy;p.rot+=p.vr;ctx.save();ctx.translate(p.x,p.y);ctx.rotate(p.rot);ctx.fillStyle=p.col;ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);ctx.restore();});if(Date.now()<end)requestAnimationFrame(loop);else document.body.removeChild(c);})();
}

/* Welcome */
document.getElementById('startBtn').addEventListener('click', ()=>{ document.getElementById('welcome-overlay').classList.add('hidden'); startPuzzle(); });

  document.getElementById('puzzle-screen').classList.remove('hidden');
  const rows=4,cols=4,img=new Image();img.src="IMG_4778.jpg";img.onload=()=>{
    const puzzle=document.getElementById('puzzle'),w=Math.min(360,innerWidth-40),h=img.height/img.width*w; 
    puzzle.style.width=w+"px";puzzle.style.height=h+"px";puzzle.style.gridTemplateColumns=`repeat(${cols},1fr)`;puzzle.style.gridTemplateRows=`repeat(${rows},1fr)`;
    let order=[...Array(rows*cols).keys()],selected=null;
    function create(){puzzle.innerHTML="";order.forEach((ti,pos)=>{const d=document.createElement('div');d.className='tile';d.style.width=(w/cols)+"px";d.style.height=(h/rows)+"px";d.style.backgroundImage="url("+img.src+")";const r=Math.floor(ti/cols),c=ti%cols;d.style.backgroundSize=`${w}px ${h}px`;d.style.backgroundPosition=`${-c*(w/cols)}px ${-r*(h/rows)}px`;d.onclick=()=>{if(selected===null)selected=pos;else if(selected===pos)selected=null;else{[order[selected],order[pos]]=[order[pos],order[selected]];selected=null;create();check();}};puzzle.appendChild(d);});}
    function shuffle(){for(let i=order.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[order[i],order[j]]=[order[j],order[i]];}if(order.every((v,i)=>v===i))shuffle();create();}
    function check(){if(order.every((v,i)=>v===i)){document.getElementById('message').innerText='🎉 Nice! Unlocking the word search…';setTimeout(()=>{document.getElementById('puzzle-screen').classList.add('hidden');startWordSearch();document.getElementById('wordsearch-screen').classList.remove('hidden');},900);}}
    shuffle();
  };
}

/* Word Search */
function startWordSearch(){
  const WORDS=["BRUNCH","EGGS","BACON","PANCAKES","COFFEE","TOAST","WAFFLES"];
  const size=12,grid=Array.from({length:size},()=>Array(size).fill(null));
  const DIRS=[[0,1],[1,0],[0,-1],[-1,0],[1,1],[1,-1],[-1,1],[-1,-1]];
  function place(word){
    for(let a=0;a<300;a++){
      const [dr,dc]=DIRS[Math.random()*DIRS.length|0];
      const r0=Math.floor(Math.random()*size),c0=Math.floor(Math.random()*size);
      const rEnd=r0+dr*(word.length-1), cEnd=c0+dc*(word.length-1);
      if(rEnd<0||rEnd>=size||cEnd<0||cEnd>=size) continue;
      let ok=true;
      for(let i=0;i<word.length;i++){
        const r=r0+dr*i,c=c0+dc*i;
        if(grid[r][c] && grid[r][c]!==word[i]){ ok=false; break; }
      }
      if(!ok) continue;
      for(let i=0;i<word.length;i++){ grid[r0+dr*i][c0+dc*i]=word[i]; }
      return true;
    }
    return false;
  }
  WORDS.forEach(w=>place(w));
  const alpha='ABCDEFGHIJKLMNOPQRSTUVWXYZ';
  for(let r=0;r<size;r++) for(let c=0;c<size;c++) if(!grid[r][c]) grid[r][c]=alpha[Math.random()*26|0];

  const wsGrid=document.getElementById('wsGrid'), wsWords=document.getElementById('wsWords');
  wsGrid.innerHTML=""; wsWords.innerHTML="";
  WORDS.forEach(w=>{const s=document.createElement('span');s.textContent=w;s.id='word_'+w;wsWords.appendChild(s);});
  for(let r=0;r<size;r++) for(let c=0;c<size;c++){const d=document.createElement('div');d.className='ws-cell';d.textContent=grid[r][c];d.dataset.r=r;d.dataset.c=c;wsGrid.appendChild(d);}

  let selecting=false,start=null,dir=null,trail=[];
  const clearTrail=(cls='ws-selected')=>trail.forEach(el=>el.classList.remove(cls));
  wsGrid.addEventListener('pointerdown',e=>{
    const t=e.target.closest('.ws-cell'); if(!t) return;
    selecting=true; start=t; dir=null; trail=[t]; t.classList.add('ws-selected');
  });
  wsGrid.addEventListener('pointerenter',e=>{
    if(!selecting) return;
    const t=e.target.closest('.ws-cell'); if(!t||trail.includes(t)) return;
    const r0=+start.dataset.r,c0=+start.dataset.c,r1=+t.dataset.r,c1=+t.dataset.c;
    const dr=Math.sign(r1-r0), dc=Math.sign(c1-c0);
    if(!dir){
      if(!((r1===r0)||(c1===c0)||Math.abs(r1-r0)===Math.abs(c1-c0))) return;
      dir=[dr,dc];
    } else if(dr!==dir[0]||dc!==dir[1]) return;
    const last=trail[trail.length-1];
    if(r1!==+last.dataset.r+dir[0] || c1!==+last.dataset.c+dir[1]) return;
    t.classList.add('ws-selected'); trail.push(t);
  });
  window.addEventListener('pointerup',()=>{
    if(!selecting) return;
    const picked=trail.map(el=>el.textContent).join(''), rev=picked.split('').reverse().join('');
    let found=null;
    for(const w of WORDS){ if(w===picked||w===rev){ found=w; break; } }
    if(found){
      clearTrail('ws-selected');
      trail.forEach(el=>el.classList.add('ws-found'));
      document.getElementById('word_'+found).classList.add('done');
      const done=[...document.querySelectorAll('.ws-words span.done')].length;
      document.getElementById('wsResult').textContent=`Found ${done}/${WORDS.length}`;
      if(done===WORDS.length){ document.getElementById('reveal').classList.remove('hidden'); confettiBurst(); }
    } else {
      clearTrail('ws-selected');
    }
    selecting=false; start=null; dir=null; trail=[];
  });
}

/* Coaster Game */
document.addEventListener('click',e=>{
  if(e.target && e.target.id==='continueCoaster'){
    document.getElementById('wordsearch-screen').classList.add('hidden');
    document.getElementById('coaster-screen').classList.remove('hidden');
    startCoasterGame();
  }
});
function startCoasterGame(){
  const canvas=document.getElementById('coasterCanvas'), ctx=canvas.getContext('2d');
  const W=canvas.width,H=canvas.height, groundY=H-30;
  const cart={x:40,y:groundY-22,w:28,h:22,vy:0}; const gravity=.6, jump=-9.5;
  const obstacles=[]; let canJump=true, frame=0, speed=3, cleared=0, gameOver=false, running=true;
  const GOAL=5;
  const jumpAction=()=>{ if(!running||gameOver) return; if(canJump){ cart.vy=jump; canJump=false; } };
  canvas.onmousedown=jumpAction; canvas.ontouchstart=(e)=>{e.preventDefault();jumpAction();}; window.onkeydown=(e)=>{ if(e.code==='Space') jumpAction(); };
  function spawn(){ const w=14+(Math.random()*8|0), h=8+(Math.random()*8|0); obstacles.push({x:W+10,y:groundY-h,w,h,counted:false}); }
  function reset(){ obstacles.length=0; frame=0; speed=3; cleared=0; gameOver=false; running=true; cart.x=40; cart.y=groundY-cart.h; cart.vy=0; canJump=true;
    document.getElementById('coasterMsg').textContent=`Tap / click to jump. Clear ${GOAL} bumps to reveal the plan!`;
    document.getElementById('coasterReveal').classList.add('hidden'); loop();
  }
  function win(){ running=false; document.getElementById('coasterMsg').textContent='Nice driving!'; document.getElementById('coasterReveal').classList.remove('hidden'); confettiBurst(); }
  function lose(){ gameOver=true; running=false; document.getElementById('coasterMsg').innerHTML='Oops! You hit a bump. <button class="link-btn" id="retryBtn">Retry</button>'; setTimeout(()=>{const r=document.getElementById('retryBtn'); if(r) r.onclick=reset;},0); }
  function update(){
    frame++; if(frame % Math.floor(90+Math.random()*20)===0){ spawn(); speed=Math.min(5.5, speed+0.15); }
    cart.vy+=gravity; cart.y+=cart.vy; if(cart.y+cart.h>=groundY){ cart.y=groundY-cart.h; cart.vy=0; canJump=true; }
    for(let i=obstacles.length-1;i>=0;i--){ const o=obstacles[i]; o.x-=speed;
      if(!o.counted && o.x+o.w<cart.x){ o.counted=true; cleared++; document.getElementById('coasterMsg').textContent=`Great! Bumps cleared: ${cleared}/${GOAL}`; if(cleared>=GOAL) return win(); }
      if(!(cart.x+cart.w<o.x||cart.x>o.x+o.w||cart.y+cart.h<o.y||cart.y>o.y+o.h)) return lose();
      if(o.x+o.w<-20) obstacles.splice(i,1);
    }
  }
  function draw(){
    ctx.fillStyle='#eaf6ff'; ctx.fillRect(0,0,W,H);
    ctx.fillStyle='#b2d9ff'; ctx.fillRect(0,groundY,W,H-groundY);
    ctx.strokeStyle='#5aa9e6'; ctx.lineWidth=3; ctx.beginPath(); ctx.moveTo(0,groundY);
    for(let x=0;x<=W;x+=10){ const y=groundY+Math.sin((frame+x)*0.02)*2; ctx.lineTo(x,y); } ctx.stroke();
    ctx.fillStyle='#5aa9e6'; obstacles.forEach(o=>ctx.fillRect(o.x,o.y,o.w,o.h));
    const base=24, extra=Math.max(0,-cart.vy)*0.8, size=Math.min(36, base+extra);
    ctx.font=`${size}px "Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji",sans-serif`; ctx.textBaseline='bottom'; ctx.fillText('🛷', cart.x, cart.y+cart.h);
  }
  function loop(){ if(!running) return; update(); draw(); requestAnimationFrame(loop); }
  reset();
}

/* Memory Game */
document.addEventListener('click',e=>{
  if(e.target && e.target.id==='continueDinner'){
    document.getElementById('coaster-screen').classList.add('hidden');
    document.getElementById('memory-screen').classList.remove('hidden');
    startMemoryGame();
  }
});
function startMemoryGame(){
  const grid=document.getElementById('memoryGrid'), msg=document.getElementById('memoryMsg'), reveal=document.getElementById('memoryReveal');
  const items=['🍷','🍗','🐟','🥗','🍝','🍰']; const deck=shuffle([...items, ...items]);
  let first=null, second=null, lock=false, matches=0;
  grid.innerHTML=''; reveal.classList.add('hidden'); msg.textContent='Find all 6 pairs.';
  deck.forEach(symbol=>{
    const card=document.createElement('div'); card.className='memory-card'; card.dataset.symbol=symbol;
    card.innerHTML=`<div class="inner"><div class="face front">${symbol}</div><div class="face back">🍽️</div></div>`;
    card.onclick=()=>{
      if(lock||card.classList.contains('matched')||card===first) return;
      card.classList.add('flipped');
      if(!first){ first=card; }
      else{
        second=card; lock=true;
        if(first.dataset.symbol===second.dataset.symbol){
          setTimeout(()=>{ first.classList.add('matched'); second.classList.add('matched'); first=second=null; lock=false; matches++; msg.textContent=\`Nice! Pairs found: ${matches}/6\`; if(matches===6){ msg.textContent='Delicious! All pairs matched.'; reveal.classList.remove('hidden'); confettiBurst(); }},350);
        }else{
          setTimeout(()=>{ first.classList.remove('flipped'); second.classList.remove('flipped'); first=second=null; lock=false; },700);
        }
      }
    };
    grid.appendChild(card);
  });
  function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }
}

/* End + Final */
document.addEventListener('click',e=>{
  if(e.target && e.target.id==='continueEnd'){
    document.getElementById('memory-screen').classList.add('hidden');
    document.getElementById('end-screen').classList.remove('hidden');
    confettiBurst();
  }
  if(e.target && e.target.id==='chooseBar') document.getElementById('choiceMsg').textContent="Perfect — let’s dress up and find a vibe ✨";
  if(e.target && e.target.id==='chooseHome') document.getElementById('choiceMsg').textContent="Cosy night it is — PJs, snacks, and cuddles 🫶";
  if(e.target && e.target.id==='finishBtn'){
    document.getElementById('end-screen').classList.add('hidden');
    document.getElementById('final-screen').classList.remove('hidden');
    // little confetti loop
    const end=Date.now()+2000; (function loop(){ confettiBurst(); if(Date.now()<end) requestAnimationFrame(loop); })();
  }
});
</script>
</body>
</html>

